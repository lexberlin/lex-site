---
import { type CollectionEntry, getEntries } from "astro:content";
import { Image } from "astro:assets";

// main layout
import BaseLayout from "./BaseLayout.astro";

// components
import Button from "@components/Button/Button.astro";

// utils
import { formatDate, humanize, slugify } from "@js/textUtils";
import { getLocaleFromUrl } from "@js/localeUtils";
interface Props {
	post: CollectionEntry<"blog">;
}

const { post } = Astro.props as Props;
const { title, description, categories, pubDate, updatedDate, heroImage } = post.data;

const currLocale = getLocaleFromUrl(Astro.url);
---

<BaseLayout
	type="blog"
	title={title}
	description={description}
	image={heroImage}
	postFrontmatter={post.data}
>
	<article class="site-container pt-24 md:pt-32">
		<!-- Blog post info -->
		<div class="flex w-full flex-col items-center">
			<div class="mx-auto flex w-full max-w-[800px]">
				<div class="mx-auto text-center">
					<!-- title -->
					<h1 class="h1 mt-8 font-sans text-5xl">{title}</h1>

					<div class="mt-4 flex items-center gap-4 mx-auto justify-center">
						<!-- Date -->
						<time datetime={pubDate.toISOString()}
							>{formatDate(pubDate, currLocale)}
						</time>
                        {
						updatedDate && (
							<div class="italic">
								<time datetime={updatedDate.toISOString()}>
									Updated: {formatDate(pubDate, currLocale)}
								</time>
							</div>
						)
					}
					</div>
				</div>
			</div>

			<!-- blog post main image -->
			<div class="mt-6 max-w-[1000px] overflow-hidden">
				<Image
					src={heroImage}
					alt={`Cover for ${title}`}
					width={2000}
					quality="high"
					class="max-h-[70vh] rounded-xl object-cover"
					loading="eager"
					format="webp"
				/>
			</div>
		</div>

		<!-- article content -->
		<div class="mt-10 w-full">
			<div class="mx-auto max-w-2xl">
				<div class="text-base-content text-base">
					<section id="blog-post-content" class="markdown-content mx-auto text-xl">
						<slot />
					</section>

					<!-- button to go back to all posts -->
					<div class="mt-16 flex justify-center">
						<Button variant="outline" href={"/blog"} arrow="left" class="py-2">
							Back to all posts
						</Button>
					</div>
				</div>
			</div>
		</div>
	</article>
</BaseLayout>
