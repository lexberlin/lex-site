---
/**
 * * Three row image marquee
 * JS allows the animation to pause while you hover over it.
 */

import { Image } from "astro:assets";
import { Icon } from "astro-icon/components";

// images
import image1 from "@assets/images/placeholder.jpg";
import image2 from "@assets/images/placeholder.jpg";
import image3 from "@assets/images/placeholder.jpg";
import image4 from "@assets/images/placeholder.jpg";
import image5 from "@assets/images/placeholder.jpg";
import image6 from "@assets/images/placeholder.jpg";
import image7 from "@assets/images/placeholder.jpg";

interface MarqueeImages {
	images: ImageMetadata[]; // imported images
}

// change these images to whatever you want!
const marqueeTop: MarqueeImages = {
	images: [image1, image2, image3, image4, image5, image6],
};

const marqueeMiddle: MarqueeImages = {
	images: [image1, image6, image4, image2, image7, image3],
};

const marqueeBottom: MarqueeImages = {
	images: [image7, image6, image5, image4, image3, image2],
};
---

<section id="feature-gallery-marquee" class="mx-auto my-12 py-12">
	<div class="flex justify-center">
		<h2 class="h2 relative inline">
			See the results
			<Icon
				name="stellar/freehand-arrow"
				class="text-primary-500 absolute top-0 right-0 h-auto w-10 translate-x-10 translate-y-7 rotate-45"
				aria-hidden="true"
			/>
		</h2>
	</div>

	<div class="relative flex flex-col gap-6 overflow-hidden md:gap-10">
		<!-- marquee top row -->
		<div class="marquee-top relative mt-8 flex gap-6 overflow-hidden md:gap-10">
			<div
				class="animate-marquee flex min-w-full shrink-0 items-center justify-around gap-6 md:gap-10"
			>
				{
					marqueeTop.images.map((image) => (
						<Image
							src={image}
							alt=""
							loading="lazy"
							width={600}
							class="aspect-[4/3] max-w-[clamp(10rem,28vmin,20rem)] rounded-md object-cover shadow-md"
						/>
					))
				}
			</div>
			<div
				aria-hidden="true"
				class="animate-marquee flex min-w-full shrink-0 items-center justify-around gap-6 md:gap-10"
			>
				{
					marqueeTop.images.map((image) => (
						<Image
							src={image}
							alt=""
							loading="lazy"
							width={600}
							class="aspect-[4/3] max-w-[clamp(10rem,28vmin,20rem)] rounded-md object-cover shadow-md"
						/>
					))
				}
			</div>
		</div>

		<!-- marquee middle row -->
		<div class="marquee-middle relative flex gap-6 overflow-hidden md:gap-10">
			<div
				class="animate-marquee flex min-w-full shrink-0 items-center justify-around gap-6 [animation-direction:reverse] md:gap-10"
			>
				{
					marqueeMiddle.images.map((image) => (
						<Image
							src={image}
							alt=""
							loading="lazy"
							width={600}
							class="aspect-[4/3] max-w-[clamp(10rem,28vmin,20rem)] rounded-md object-cover shadow-md"
						/>
					))
				}
			</div>
			<div
				aria-hidden="true"
				class="animate-marquee flex min-w-full shrink-0 items-center justify-around gap-6 [animation-direction:reverse] md:gap-10"
			>
				{
					marqueeMiddle.images.map((image) => (
						<Image
							src={image}
							alt=""
							loading="lazy"
							width={600}
							class="aspect-[4/3] max-w-[clamp(10rem,28vmin,20rem)] rounded-md object-cover shadow-md"
						/>
					))
				}
			</div>
		</div>

		<!-- marquee bottom row -->
		<div class="marquee-bottom relative flex gap-6 overflow-hidden md:gap-10">
			<div
				class="animate-marquee flex min-w-full shrink-0 items-center justify-around gap-6 md:gap-10"
			>
				{
					marqueeBottom.images.map((image) => (
						<Image
							src={image}
							alt=""
							loading="lazy"
							width={600}
							class="aspect-[4/3] max-w-[clamp(10rem,28vmin,20rem)] rounded-md object-cover shadow-md"
						/>
					))
				}
			</div>
			<div
				aria-hidden="true"
				class="animate-marquee flex min-w-full shrink-0 items-center justify-around gap-6 md:gap-10"
			>
				{
					marqueeBottom.images.map((image) => (
						<Image
							src={image}
							alt=""
							loading="lazy"
							width={600}
							class="aspect-[4/3] max-w-[clamp(10rem,28vmin,20rem)] rounded-md object-cover shadow-md"
						/>
					))
				}
			</div>
		</div>
	</div>
</section>

<script>
	const setupMarquee = () => {
		const marqueeTop = document.querySelector(".marquee-top");
		const marqueeMiddle = document.querySelector(".marquee-middle");
		const marqueeBottom = document.querySelector(".marquee-bottom");

		// add the clauss "pause" when the mouse enters the marquee
		marqueeTop?.addEventListener("mouseover", () => {
			marqueeTop.querySelectorAll(".animate-marquee").forEach((el) => {
				el.classList.add("pause");
			});
		});
		marqueeMiddle?.addEventListener("mouseover", () => {
			marqueeMiddle.querySelectorAll(".animate-marquee").forEach((el) => {
				el.classList.add("pause");
			});
		});
		marqueeBottom?.addEventListener("mouseover", () => {
			marqueeBottom.querySelectorAll(".animate-marquee").forEach((el) => {
				el.classList.add("pause");
			});
		});

		// remove the class "pause" when the mouse leaves the marquee
		marqueeTop?.addEventListener("mouseout", () => {
			marqueeTop.querySelectorAll(".animate-marquee").forEach((el) => {
				el.classList.remove("pause");
			});
		});
		marqueeMiddle?.addEventListener("mouseout", () => {
			marqueeMiddle.querySelectorAll(".animate-marquee").forEach((el) => {
				el.classList.remove("pause");
			});
		});
		marqueeBottom?.addEventListener("mouseout", () => {
			marqueeBottom.querySelectorAll(".animate-marquee").forEach((el) => {
				el.classList.remove("pause");
			});
		});
	};

	// runs on initial page load
	setupMarquee();

	// runs on view transitions navigation
	document.addEventListener("astro:after-swap", setupMarquee);
</script>
